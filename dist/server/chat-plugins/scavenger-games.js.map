{
  "version": 3,
  "sources": ["../../../server/chat-plugins/scavenger-games.ts"],
  "sourcesContent": ["/**\n * Scavengers Games Plugin\n * Pokemon Showdown - http://pokemonshowdown.com/\n *\n * This plugin stores the different possible game modes and twists that take place in scavengers room\n *\n * @license MIT license\n */\n\nimport { ScavengerHunt, type ScavengerHuntPlayer, sanitizeAnswer } from './scavengers';\nimport { Utils } from '../../lib';\n\nexport type TwistEvent = (this: ScavengerHunt, ...args: any[]) => void;\ninterface Twist {\n\tname: string;\n\tid: string;\n\tisGameMode?: true;\n\tdesc?: string;\n\t[eventid: string]: string | number | TwistEvent | boolean | undefined;\n}\n\ntype GameModeFunction = (this: ScavengerGameTemplate, ...args: any[]) => void;\ninterface GameMode {\n\tname: string;\n\tid: string;\n\tmod: Twist;\n\tround?: number;\n\tleaderboard?: true;\n\tteamAnnounce?: GameModeFunction;\n\tgetPlayerTeam?: GameModeFunction;\n\tadvanceTeam?: GameModeFunction;\n\t[k: string]: any;\n}\n\nfunction toSeconds(time: string) {\n\t// hhmmss => ss\n\tconst parts = time.split(':').reverse();\n\treturn parts.map((value, index) => parseInt(value) * (60 ** index)).reduce((a, b) => a + b);\n}\n\nclass Leaderboard {\n\tdata: { [userid: string]: AnyObject };\n\n\tconstructor() {\n\t\tthis.data = {};\n\t}\n\n\taddPoints(name: string, aspect: string, points: number, noUpdate?: boolean) {\n\t\tconst userid: string = toID(name);\n\n\t\tif (!userid || userid === 'constructor' || !points) return this;\n\t\tif (!this.data[userid]) this.data[userid] = { name };\n\n\t\tif (!this.data[userid][aspect]) this.data[userid][aspect] = 0;\n\t\tthis.data[userid][aspect] += points;\n\n\t\tif (!noUpdate) this.data[userid].name = name; // always keep the last used name\n\n\t\treturn this; // allow chaining\n\t}\n\n\tvisualize(sortBy: string): Promise<({ rank: number } & AnyObject)[]>;\n\tvisualize(sortBy: string, userid: string): Promise<({ rank: number } & AnyObject) | undefined>;\n\tvisualize(sortBy: string, userid?: string) {\n\t\t// FIXME: this is not how promises work\n\t\t// return a promise for async sorting - make this less exploitable\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet lowestScore = Infinity;\n\t\t\tlet lastPlacement = 1;\n\n\t\t\tconst ladder = Utils.sortBy(\n\t\t\t\tObject.entries(this.data).filter(([u, bit]) => sortBy in bit),\n\t\t\t\t([u, bit]) => -bit[sortBy]\n\t\t\t).map(([u, bit], i) => {\n\t\t\t\tif (bit[sortBy] !== lowestScore) {\n\t\t\t\t\tlowestScore = bit[sortBy];\n\t\t\t\t\tlastPlacement = i + 1;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\trank: lastPlacement,\n\t\t\t\t\t...bit,\n\t\t\t\t} as { rank: number } & AnyObject;\n\t\t\t}); // identify ties\n\t\t\tif (userid) {\n\t\t\t\tconst rank = ladder.find(entry => toID(entry.name) === userid);\n\t\t\t\tresolve(rank);\n\t\t\t} else {\n\t\t\t\tresolve(ladder);\n\t\t\t}\n\t\t});\n\t}\n\n\tasync htmlLadder(): Promise<string> {\n\t\tconst data = await this.visualize('points');\n\t\treturn `<div class=\"ladder\" style=\"overflow-y: scroll; max-height: 170px;\"><table style=\"width: 100%\"><tr><th>Rank</th><th>Name</th><th>Points</th></tr>${data.map(line =>\n\t\t\t`<tr><td>${line.rank}</td><td>${line.name}</td><td>${line.points}</td></tr>`).join('')\n\t\t}</table></div>`;\n\t}\n}\n\nconst TWISTS: { [k: string]: Twist } = {\n\tperfectscore: {\n\t\tname: 'Perfect Score',\n\t\tid: 'perfectscore',\n\t\tdesc: \"Players who finish the hunt without submitting a single wrong answer get a shoutout!\",\n\n\t\tonLeave(player) {\n\t\t\tif (!this.leftGame) this.leftGame = [];\n\t\t\tthis.leftGame.push(player.id);\n\t\t},\n\n\t\tonSubmitPriority: 1,\n\t\tonSubmit(player, value) {\n\t\t\tconst currentQuestion = player.currentQuestion;\n\n\t\t\tif (!player.answers) player.answers = {};\n\t\t\tif (!player.answers[currentQuestion]) player.answers[currentQuestion] = [];\n\n\t\t\tif (player.answers[currentQuestion].includes(value)) return;\n\n\t\t\tplayer.answers[currentQuestion].push(value);\n\t\t},\n\n\t\tonComplete(player, time, blitz) {\n\t\t\tconst isPerfect = !this.leftGame?.includes(player.id) &&\n\t\t\t\tObject.values(player.answers).every((attempts: any) => attempts.length <= 1);\n\t\t\treturn { name: player.name, time, blitz, isPerfect };\n\t\t},\n\n\t\tonAfterEndPriority: 1,\n\t\tonAfterEnd(isReset) {\n\t\t\tif (isReset) return;\n\t\t\tconst perfect = this.completed.filter(entry => entry.isPerfect).map(entry => entry.name);\n\t\t\tif (perfect.length) {\n\t\t\t\tthis.announce(Utils.html`${Chat.toListString(perfect)} ${perfect.length > 1 ? 'have' : 'has'} completed the hunt without a single wrong answer!`);\n\t\t\t}\n\t\t},\n\t},\n\n\tbonusround: {\n\t\tname: 'Bonus Round',\n\t\tid: 'bonusround',\n\t\tdesc: \"Players can choose whether or not they choose to complete the 4th question.\",\n\n\t\tonAfterLoad() {\n\t\t\tif (this.questions.length === 3) {\n\t\t\t\tthis.announce('This twist requires at least four questions.  Please reset the hunt and make it again.');\n\t\t\t\tthis.huntLocked = true;\n\t\t\t} else {\n\t\t\t\tthis.questions[this.questions.length - 1].hint += ' (You may choose to skip this question using ``/scavenge skip``.)';\n\t\t\t}\n\t\t},\n\n\t\tonAnySubmit(player) {\n\t\t\tif (this.huntLocked) {\n\t\t\t\tplayer.sendRoom('The hunt was not set up correctly.  Please wait for the host to reset the hunt and create a new one.');\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tonSubmitPriority: 1,\n\t\tonSubmit(player, value) {\n\t\t\tconst currentQuestion = player.currentQuestion;\n\n\t\t\tif (value === 'skip' && currentQuestion + 1 === this.questions.length) {\n\t\t\t\tplayer.sendRoom('You have opted to skip the current question.');\n\t\t\t\tplayer.skippedQuestion = true;\n\t\t\t\tthis.onComplete(player);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tonComplete(player, time, blitz) {\n\t\t\tconst noSkip = !player.skippedQuestion;\n\t\t\treturn { name: player.name, time, blitz, noSkip };\n\t\t},\n\n\t\tonAfterEndPriority: 1,\n\t\tonAfterEnd(isReset) {\n\t\t\tif (isReset) return;\n\t\t\tconst noSkip = this.completed.filter(entry => entry.noSkip).map(entry => entry.name);\n\t\t\tif (noSkip.length) {\n\t\t\t\tthis.announce(Utils.html`${Chat.toListString(noSkip)} ${noSkip.length > 1 ? 'have' : 'has'} completed the hunt without skipping the last question!`);\n\t\t\t}\n\t\t},\n\t},\n\n\tincognito: {\n\t\tname: 'Incognito',\n\t\tid: 'incognito',\n\t\tdesc: \"Upon answering the last question correctly, the player's finishing time will not be announced in the room!  Results will only be known at the end of the hunt.\",\n\n\t\tonCorrectAnswer(player, value) {\n\t\t\tif (player.currentQuestion + 1 >= this.questions.length) {\n\t\t\t\tthis.runEvent('PreComplete', player);\n\n\t\t\t\tplayer.sendRoom(`Congratulations! You have gotten the correct answer.`);\n\t\t\t\tplayer.sendRoom(`This is a special style where finishes aren't announced! To see your placement, wait for the hunt to end. Until then, it's your secret that you finished!`);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\tonPreComplete(player) {\n\t\t\tconst now = Date.now();\n\t\t\tconst time = Chat.toDurationString(now - this.startTime, { hhmmss: true });\n\t\t\tconst canBlitz = this.completed.length < 3;\n\n\t\t\tconst blitz = now - this.startTime <= 60000 && canBlitz &&\n\t\t\t\t(this.room.settings.scavSettings?.blitzPoints?.[this.gameType] || this.gameType === 'official');\n\n\t\t\tconst result = this.runEvent('Complete', player, time, blitz) || { name: player.name, time, blitz };\n\n\t\t\tthis.preCompleted = this.preCompleted ? [...this.preCompleted, result] : [result];\n\t\t\tplayer.completed = true;\n\t\t\tplayer.destroy();\n\t\t},\n\n\t\tonEnd() {\n\t\t\tthis.completed = this.preCompleted || [];\n\t\t},\n\t},\n\n\tspamfilter: {\n\t\tname: 'Spam Filter',\n\t\tid: 'spamfilter',\n\n\t\tdesc: 'Every wrong answer adds 30 seconds to your final time!',\n\n\t\tonIncorrectAnswer(player: ScavengerHuntPlayer, value: string) {\n\t\t\tif (!player.incorrect) player.incorrect = [];\n\t\t\tconst id = `${player.currentQuestion}-${value}`;\n\t\t\tif (player.incorrect.includes(id)) return;\n\n\t\t\tplayer.incorrect.push(id);\n\t\t},\n\n\t\tonComplete(player, time, blitz) {\n\t\t\tconst seconds = toSeconds(time);\n\t\t\tif (!player.incorrect) return { name: player.name, total: seconds, blitz, time, original_time: time };\n\n\t\t\tconst total = seconds + (30 * player.incorrect.length);\n\t\t\tconst finalTime = Chat.toDurationString(total * 1000, { hhmmss: true });\n\t\t\tif (total > 60) blitz = false;\n\n\t\t\treturn { name: player.name, total, blitz, time: finalTime, original_time: time };\n\t\t},\n\n\t\tonConfirmCompletion(player, time, blitz, place, result) {\n\t\t\tblitz = result.blitz;\n\t\t\ttime = result.time;\n\t\t\tconst deductionMessage = player.incorrect?.length ?\n\t\t\t\tChat.count(player.incorrect, 'incorrect guesses', 'incorrect guess') :\n\t\t\t\t\"Perfect!\";\n\t\t\treturn `<em>${Utils.escapeHTML(player.name)}</em> has finished the hunt! (Final Time: ${time} - ${deductionMessage}${(blitz ? \" - BLITZ\" : \"\")})`;\n\t\t},\n\n\t\tonEnd() {\n\t\t\tUtils.sortBy(this.completed, entry => entry.total);\n\t\t},\n\t},\n\n\tblindincognito: {\n\t\tname: 'Blind Incognito',\n\t\tid: 'blindincognito',\n\t\tdesc: \"Upon completing the last question, neither you nor other players will know if the last question is correct!  You may be in for a nasty surprise when the hunt ends!\",\n\n\t\tonAnySubmit(player, value) {\n\t\t\tif (player.precompleted) {\n\t\t\t\tplayer.sendRoom(`That may or may not be the right answer - if you aren't confident, you can try again!`);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tonCorrectAnswer(player, value) {\n\t\t\tif (player.currentQuestion + 1 >= this.questions.length) {\n\t\t\t\tthis.runEvent('PreComplete', player);\n\n\t\t\t\tplayer.sendRoom(`That may or may not be the right answer - if you aren't confident, you can try again!`);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tonIncorrectAnswer(player, value) {\n\t\t\tif (player.currentQuestion + 1 >= this.questions.length) {\n\t\t\t\tplayer.sendRoom(`That may or may not be the right answer - if you aren't confident, you can try again!`);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\tonPreComplete(player) {\n\t\t\tconst now = Date.now();\n\t\t\tconst time = Chat.toDurationString(now - this.startTime, { hhmmss: true });\n\t\t\tconst canBlitz = this.completed.length < 3;\n\n\t\t\tconst blitz = now - this.startTime <= 60000 && canBlitz &&\n\t\t\t\t(this.room.settings.scavSettings?.blitzPoints?.[this.gameType] || this.gameType === 'official');\n\n\t\t\tconst result = this.runEvent('Complete', player, time, blitz) || { name: player.name, time, blitz };\n\n\t\t\tthis.preCompleted = this.preCompleted ? [...this.preCompleted, result] : [result];\n\t\t\tplayer.precompleted = true;\n\t\t},\n\n\t\tonEnd() {\n\t\t\tthis.completed = this.preCompleted || [];\n\t\t},\n\t},\n\n\ttimetrial: {\n\t\tname: 'Time Trial',\n\t\tid: 'timetrial',\n\t\tdesc: \"Time starts when the player starts the hunt!\",\n\n\t\tonAfterLoad() {\n\t\t\tif (this.questions.length === 3) {\n\t\t\t\tthis.announce('This twist requires at least four questions. Please reset the hunt and make it again.');\n\t\t\t\tthis.huntLocked = true;\n\t\t\t}\n\t\t\tthis.altIps = {};\n\t\t\tthis.startTimes = {};\n\t\t},\n\n\t\tonJoin(user: User) {\n\t\t\tif (!Config.noipchecks) {\n\t\t\t\tconst altIp = user.ips.find(ip => this.altIps[ip] && this.altsIps[ip].id !== user.id);\n\t\t\t\tif (altIp) {\n\t\t\t\t\tuser.sendTo(this.room, `You already have started the hunt as ${this.altIps[altIp].name}.`);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!this.startTimes[user.id]) this.startTimes[user.id] = Date.now();\n\t\t\tif (this.addPlayer(user)) {\n\t\t\t\tthis.cacheUserIps(user);\n\t\t\t\tdelete this.leftHunt[user.id];\n\t\t\t\tuser.sendTo(this.room, \"You joined the scavenger hunt! Use the command /scavenge to answer.\");\n\t\t\t\tthis.onSendQuestion(user);\n\t\t\t} else {\n\t\t\t\tuser.sendTo(this.room, \"You have already joined the hunt.\");\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\tonLeave(player) {\n\t\t\tfor (const ip of player.joinIps) {\n\t\t\t\tthis.altIps[ip] = { id: player.id, name: player.name };\n\t\t\t}\n\t\t},\n\n\t\tonAnySubmit(player) {\n\t\t\tif (this.huntLocked) {\n\t\t\t\tplayer.sendRoom('The hunt was not set up correctly.  Please wait for the host to reset the hunt and create a new one.');\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tonComplete(player, time, blitz) {\n\t\t\tconst now = Date.now();\n\t\t\tconst takenTime = now - this.startTimes[player.id];\n\t\t\tconst result = {\n\t\t\t\tname: player.name,\n\t\t\t\tid: player.id,\n\t\t\t\ttime: Chat.toDurationString(takenTime, { hhmmss: true }),\n\t\t\t\tduration: takenTime,\n\t\t\t\tblitz,\n\t\t\t};\n\t\t\tthis.completed.push(result);\n\t\t\tconst place = Utils.formatOrder(this.completed.length);\n\n\t\t\tthis.announce(\n\t\t\t\tUtils.html`<em>${result.name}</em> is the ${place} player to finish the hunt! (${takenTime}${(blitz ? \" - BLITZ\" : \"\")})`\n\t\t\t);\n\t\t\tUtils.sortBy(this.completed, entry => entry.duration);\n\n\t\t\tplayer.destroy(); // remove from user.games;\n\t\t\treturn true;\n\t\t},\n\t},\n\n\tscavengersfeud: {\n\t\tid: 'scavengersfeud',\n\t\tname: 'Scavengers Feud',\n\t\tdesc: 'After completing the hunt, players will guess what the most common incorrect answer for each question is.',\n\t\tonAfterLoad() {\n\t\t\tthis.guesses = {};\n\t\t\tthis.incorrect = this.questions.map(() => ({}));\n\n\t\t\tthis.questions.push({\n\t\t\t\thint: 'Please enter what you think are the most common incorrect answers to each question.  (Enter your guesses in the order of the previous questions, and separate them with a comma)',\n\t\t\t\tanswer: ['Any'],\n\t\t\t\tspoilers: [],\n\t\t\t});\n\t\t},\n\n\t\tonIncorrectAnswer(player: ScavengerHuntPlayer, value: string) {\n\t\t\tconst curr = player.currentQuestion;\n\n\t\t\tif (!this.incorrect[curr][value]) this.incorrect[curr][value] = [];\n\t\t\tif (this.incorrect[curr][value].includes(player.id)) return;\n\n\t\t\tthis.incorrect[curr][value].push(player.id);\n\t\t},\n\n\t\tonSubmitPriority: 1,\n\t\tonSubmit(player, jumble, value) {\n\t\t\tconst currentQuestion = player.currentQuestion;\n\n\t\t\tif (currentQuestion + 1 === this.questions.length) {\n\t\t\t\tthis.guesses[player.id] = value.split(',').map((part: string) => sanitizeAnswer(part));\n\n\t\t\t\tthis.onComplete(player);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tonEnd() {\n\t\t\tthis.questions = this.questions.slice(0, -1); // remove the automatically added last question.\n\t\t},\n\n\t\tonAfterEnd(isReset) {\n\t\t\tif (isReset) return;\n\n\t\t\tconst buffer = [];\n\t\t\tfor (const [idx, data] of this.incorrect.entries()) {\n\t\t\t\t// collate the data for each question\n\t\t\t\tlet collection = [];\n\t\t\t\tfor (const str in data) {\n\t\t\t\t\tcollection.push({ count: data[str].length, value: str });\n\t\t\t\t}\n\t\t\t\tcollection = collection.sort((a, b) => b.count - a.count);\n\t\t\t\tconst maxValue = collection[0]?.count || 0;\n\n\t\t\t\tconst matches = collection\n\t\t\t\t\t.filter(pair => pair.count === maxValue)\n\t\t\t\t\t.map(pair => pair.value);\n\n\t\t\t\tconst matchedPlayers = [];\n\t\t\t\tfor (const playerid in this.guesses) {\n\t\t\t\t\tconst guesses = this.guesses[playerid];\n\t\t\t\t\tif (matches.includes(guesses[idx])) matchedPlayers.push(playerid);\n\t\t\t\t}\n\n\t\t\t\t// display the data\n\t\t\t\tconst matchDisplay = matches.length ? matches.join(', ') : 'No wrong answers!';\n\t\t\t\tconst playerDisplay = matches.length ?\n\t\t\t\t\tmatchedPlayers.length ? `- ${matchedPlayers.join(', ')}` : '- No one guessed correctly!' :\n\t\t\t\t\t'';\n\t\t\t\tbuffer.push(`Q${idx + 1}: ${matchDisplay} ${playerDisplay}`);\n\t\t\t}\n\n\t\t\tthis.announce(`<h3>Most common incorrect answers:</h3>${buffer.join('<br />')}`);\n\t\t},\n\t},\n\n\tpointless: {\n\t\tid: 'pointless',\n\t\tname: 'Pointless',\n\t\tdesc: 'Players get bonus points for guessing the least commonly guessed answers.',\n\t\tonAfterLoad() {\n\t\t\tthis.correct = this.questions.map(() => ({}));\n\t\t},\n\n\t\tonCorrectAnswer(player: ScavengerHuntPlayer, value: string) {\n\t\t\tconst curr = player.currentQuestion;\n\n\t\t\tif (!this.correct[curr][value]) this.correct[curr][value] = [];\n\t\t\tif (this.correct[curr][value].includes(player.id)) return;\n\n\t\t\tthis.correct[curr][value].push(player.id);\n\t\t},\n\n\t\tonAfterEnd(isReset) {\n\t\t\tif (isReset) return;\n\n\t\t\tconst buffer = [];\n\n\t\t\tfor (const [idx, data] of this.correct.entries()) {\n\t\t\t\t// collect the data for each question\n\t\t\t\tconst list = Object.entries<string[]>(data).map(([value, players]) => ({ players, count: players.length, value }));\n\t\t\t\tconst minValue = Math.min(...list.map(entry => entry.count));\n\n\t\t\t\tconst minEntries = list.filter(entry => entry.count === minValue);\n\t\t\t\tconst matchDisplay = minEntries.map(entry =>\n\t\t\t\t\tthis.questions[idx].answer.find(answer => toID(answer) === entry.value)).join(', ');\n\t\t\t\tconst playerDisplay = minEntries.flatMap(entry =>\n\t\t\t\t\tentry.players.map(foundPlayer => this.players.find(player => player.id === foundPlayer)!.name)).join(', ');\n\t\t\t\tbuffer.push(`Q${idx + 1}: ${matchDisplay} - ${playerDisplay}`);\n\t\t\t}\n\n\t\t\tthis.announce(`<h3>Least frequent correct answers:</h3>${buffer.join('<br />')}`);\n\t\t},\n\t},\n\n\tminesweeper: {\n\t\tid: 'minesweeper',\n\t\tname: 'Minesweeper',\n\t\tdesc: 'The huntmaker adds \\'mines\\' to the hunt using `!(mine)` - players that dodge all mines get extra points, while the huntmaker gets points every time a mine is hit.',\n\t\tonAfterLoad() {\n\t\t\tthis.guesses = this.questions.map(() => []);\n\t\t\tthis.mines = [];\n\t\t\tfor (const question of this.questions) {\n\t\t\t\tthis.mines.push(question.answer.filter(ans => ans.startsWith('!')));\n\t\t\t\tquestion.answer = question.answer.filter(ans => !ans.startsWith('!'));\n\t\t\t}\n\t\t\tif ((this.mines as string[][]).some(mineSet => mineSet.length === 0)) {\n\t\t\t\tthis.announce('This twist requires at least one mine for each question. Please reset the hunt and make it again.');\n\t\t\t\tthis.huntLocked = true;\n\t\t\t}\n\t\t},\n\n\t\tonEditQuestion(questionNumber: number, questionAnswer: string, value: string) {\n\t\t\tif (questionAnswer === 'question') questionAnswer = 'hint';\n\t\t\tif (!['hint', 'answer'].includes(questionAnswer)) return false;\n\n\t\t\tlet answer: string[] = [];\n\t\t\tif (questionAnswer === 'answer') {\n\t\t\t\tanswer = value.split(';').map(p => p.trim());\n\t\t\t}\n\n\t\t\tif (!questionNumber || questionNumber < 1 || questionNumber > this.questions.length || (!answer && !value)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tquestionNumber--; // indexOf starts at 0\n\n\t\t\tif (questionAnswer === 'answer') {\n\t\t\t\t// These two lines are the only difference from the original\n\t\t\t\tthis.mines[questionNumber] = answer.filter(ans => ans.startsWith('!'));\n\t\t\t\tthis.questions[questionNumber].answer = answer.filter(ans => !ans.startsWith('!'));\n\t\t\t} else {\n\t\t\t\tthis.questions[questionNumber].hint = value;\n\t\t\t}\n\n\t\t\tthis.announce(`The ${questionAnswer} for question ${questionNumber + 1} has been edited.`);\n\t\t\tif (questionAnswer === 'hint') {\n\t\t\t\tfor (const p in this.playerTable) {\n\t\t\t\t\tthis.playerTable[p].onNotifyChange(questionNumber);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\tonAnySubmit(player) {\n\t\t\tif (this.huntLocked) {\n\t\t\t\tplayer.sendRoom('The hunt was not set up correctly.  Please wait for the host to reset the hunt and create a new one.');\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tonIncorrectAnswer(player: ScavengerHuntPlayer, value: string) {\n\t\t\tconst curr = player.currentQuestion;\n\n\t\t\tif (!this.guesses[curr][player.id]) this.guesses[curr][player.id] = new Set();\n\t\t\tthis.guesses[curr][player.id].add(sanitizeAnswer(value));\n\n\t\t\tthrow new Chat.ErrorMessage(\"That is not the answer - try again!\");\n\t\t},\n\n\t\tonShowEndBoard(endedBy?: User) {\n\t\t\tconst sliceIndex = this.gameType === 'official' ? 5 : 3;\n\t\t\tconst hosts = Chat.toListString(this.hosts.map(h => `<em>${Utils.escapeHTML(h.name)}</em>`));\n\n\t\t\tconst mines: { mine: string, users: string[] }[][] = [];\n\n\t\t\tfor (const mineSet of this.mines as string[][]) {\n\t\t\t\tmines.push(mineSet.map(mine => ({ mine: mine.substr(1), users: [] as string[] })));\n\t\t\t}\n\n\t\t\tfor (const player of Object.values(this.playerTable)) {\n\t\t\t\tif (!player) continue;\n\t\t\t\tif (player.mines) {\n\t\t\t\t\tfor (const { index, mine } of player.mines) {\n\t\t\t\t\t\tmines[index].find(obj => obj.mine === mine)?.users.push(player.name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const mineSet of mines) mineSet.sort();\n\n\t\t\tthis.announce(\n\t\t\t\t`The ${this.gameType ? `${this.gameType} ` : \"\"}scavenger hunt by ${hosts} was ended ${(endedBy ? \"by \" + Utils.escapeHTML(endedBy.name) : \"automatically\")}.<br />` +\n\t\t\t\t`${this.completed.slice(0, sliceIndex).map((p, i) => `${Utils.formatOrder(i + 1)} place: <em>${Utils.escapeHTML(p.name)}</em> <span style=\"color: lightgreen;\">[${p.time}]</span>.<br />`).join(\"\")}` +\n\t\t\t\t`${this.completed.length > sliceIndex ? `Consolation Prize: ${this.completed.slice(sliceIndex).map(e => `<em>${Utils.escapeHTML(e.name)}</em> <span style=\"color: lightgreen;\">[${e.time}]</span>`).join(', ')}<br />` : ''}<br />` +\n\t\t\t\t`<details style=\"cursor: pointer;\"><summary>Solution: </summary><br />` +\n\t\t\t\t`${this.questions.map((q, i) => (\n\t\t\t\t\t`${i + 1}) ${this.formatOutput(q.hint)} <span style=\"color: lightgreen\">[<em>${Utils.escapeHTML(q.answer.join(' / '))}</em>]</span><br/>` +\n\t\t\t\t\t`<details style=\"cursor: pointer;\"><summary>Mines: </summary>${mines[i].map(({ mine, users }) => Utils.escapeHTML(`${mine}: ${users.join(' / ') || '-'}`)).join('<br />')}</details>`\n\t\t\t\t)).join(\"<br />\")}` +\n\t\t\t\t`</details>`\n\t\t\t);\n\t\t\treturn true;\n\t\t},\n\n\t\tonEnd(isReset) {\n\t\t\tif (isReset) return;\n\t\t\tfor (const [q, guessObj] of this.guesses.entries()) {\n\t\t\t\tconst mines: string[] = this.mines[q];\n\t\t\t\tfor (const [playerId, guesses] of Object.entries(guessObj)) {\n\t\t\t\t\tconst player = this.playerTable[playerId];\n\t\t\t\t\tif (!player) continue;\n\t\t\t\t\tif (!player.mines) player.mines = [];\n\t\t\t\t\t(player.mines as { index: number, mine: string }[]).push(...mines\n\t\t\t\t\t\t.filter(mine => (guesses as Set<string>).has(sanitizeAnswer(mine)))\n\t\t\t\t\t\t.map(mine => ({ index: q, mine: mine.substr(1) })));\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tonAfterEndPriority: 1,\n\t\tonAfterEnd(isReset) {\n\t\t\tif (isReset) return;\n\t\t\tconst noMines = [];\n\t\t\tfor (const { name } of this.completed) {\n\t\t\t\tconst player = this.playerTable[toID(name)];\n\t\t\t\tif (!player) continue;\n\t\t\t\tif (!player.mines?.length) noMines.push(name);\n\t\t\t}\n\t\t\tif (noMines.length) {\n\t\t\t\tthis.announce(Utils.html`${Chat.toListString(noMines)} ${noMines.length > 1 ? 'have' : 'has'} completed the hunt without hitting a single mine!`);\n\t\t\t\t// Points are awarded manually\n\t\t\t}\n\t\t},\n\t},\n};\n\nconst MODES: { [k: string]: GameMode | string } = {\n\tko: 'kogames',\n\tkogames: {\n\t\tname: 'KO Games',\n\t\tid: 'kogames',\n\n\t\tmod: {\n\t\t\tname: 'KO Games',\n\t\t\tid: 'KO Games',\n\t\t\tisGameMode: true,\n\n\t\t\tonLoad() {\n\t\t\t\tthis.allowRenames = false; // don't let people change their name in the middle of the hunt.\n\t\t\t},\n\n\t\t\tonJoin(user: User) {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tif (game.playerlist && !game.playerlist.includes(user.id)) {\n\t\t\t\t\tuser.sendTo(this.room, 'You are not allowed to join this scavenger hunt.');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonAfterEnd() {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tif (!this.completed.length) {\n\t\t\t\t\tthis.announce('No one has completed the hunt - the round has been void.');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tgame.round++;\n\n\t\t\t\t// elimination\n\t\t\t\tif (!game.playerlist) {\n\t\t\t\t\tgame.playerlist = this.completed.map(entry => toID(entry.name));\n\t\t\t\t\tthis.announce(`Round ${game.round} - ${Chat.toListString(this.completed.map(p => `<em>${p.name}</em>`))} have successfully completed the last hunt and have moved on to the next round!`);\n\t\t\t\t} else {\n\t\t\t\t\tlet eliminated = [];\n\t\t\t\t\tconst completed = this.completed.map(entry => toID(entry.name)) as string[];\n\t\t\t\t\tif (completed.length === game.playerlist.length) {\n\t\t\t\t\t\teliminated.push(completed.pop()); // eliminate one\n\t\t\t\t\t\tgame.playerlist = game.playerlist.filter(userid => completed.includes(userid));\n\t\t\t\t\t} else {\n\t\t\t\t\t\teliminated = game.playerlist.filter(userid => !completed.includes(userid));\n\t\t\t\t\t\tfor (const username of eliminated) {\n\t\t\t\t\t\t\tconst userid = toID(username);\n\t\t\t\t\t\t\tgame.playerlist = game.playerlist.filter(pid => pid !== userid);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.announce(`Round ${game.round} - ${Chat.toListString(eliminated.map(n => `<em>${n}</em>`))} ${Chat.plural(eliminated, 'have', 'has')} been eliminated! ${Chat.toListString(game.playerlist.map(p => `<em>${this.playerTable[p].name}</em>`))} have successfully completed the last hunt and have moved on to the next round!`);\n\t\t\t\t}\n\n\t\t\t\t// process end of game\n\t\t\t\tif (game.playerlist.length === 1) {\n\t\t\t\t\tconst winningUser = Users.get(game.playerlist[0]);\n\t\t\t\t\tconst winner = winningUser ? winningUser.name : game.playerlist[0];\n\n\t\t\t\t\tthis.announce(`Congratulations to the winner - ${winner}!`);\n\t\t\t\t\tgame.destroy();\n\t\t\t\t} else if (!game.playerlist.length) {\n\t\t\t\t\tthis.announce('Everyone has been eliminated!  Better luck next time!');\n\t\t\t\t\tgame.destroy();\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\n\t\tround: 0,\n\t\tplayerlist: null,\n\t},\n\n\tscav: 'scavengergames',\n\tscavgames: 'scavengergames',\n\tscavengergames: {\n\t\tname: 'Scavenger Games',\n\t\tid: 'scavengergames',\n\n\t\tmod: {\n\t\t\tname: 'Scavenger Games',\n\t\t\tid: 'scavengergames',\n\t\t\tisGameMode: true,\n\n\t\t\tonLoad() {\n\t\t\t\tthis.allowRenames = false; // don't let people change their name in the middle of the hunt.\n\t\t\t\tthis.setTimer(1);\n\t\t\t},\n\n\t\t\tonJoin(user) {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tif (game.playerlist && !game.playerlist.includes(user.id)) {\n\t\t\t\t\tuser.sendTo(this.room, 'You are not allowed to join this scavenger hunt.');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonAfterEnd() {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tif (!this.completed.length) {\n\t\t\t\t\tthis.announce('No one has completed the hunt - the round has been void.');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tgame.round++;\n\n\t\t\t\tlet eliminated: string[] = [];\n\t\t\t\tif (!game.playerlist) {\n\t\t\t\t\tgame.playerlist = this.completed.map(entry => toID(entry.name) as string);\n\t\t\t\t} else {\n\t\t\t\t\tconst completed = this.completed.map(entry => toID(entry.name) as string);\n\t\t\t\t\teliminated = game.playerlist.filter(userid => !completed.includes(userid));\n\t\t\t\t\tfor (const username of eliminated) {\n\t\t\t\t\t\tconst userid = toID(username);\n\t\t\t\t\t\tgame.playerlist = game.playerlist.filter(pid => pid !== userid);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.announce(`Round ${game.round} - ${Chat.toListString(eliminated.map(n => `<em>${n}</em>`))} ${eliminated.length ? `${Chat.plural(eliminated, 'have', 'has')} been eliminated!` : ''} ${Chat.toListString(game.playerlist.map(p => `<em>${this.playerTable[p].name}</em>`))} have successfully completed the last hunt and have moved on to the next round!`);\n\n\t\t\t\t// process end of game\n\t\t\t\tif (game.playerlist.length === 1) {\n\t\t\t\t\tconst winningUser = Users.get(game.playerlist[0]);\n\t\t\t\t\tconst winner = winningUser ? winningUser.name : game.playerlist[0];\n\n\t\t\t\t\tthis.announce(`Congratulations to the winner - ${winner}!`);\n\t\t\t\t\tgame.destroy();\n\t\t\t\t} else if (!game.playerlist.length) {\n\t\t\t\t\tthis.announce('Everyone has been eliminated!  Better luck next time!');\n\t\t\t\t\tgame.destroy();\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\n\t\tround: 0,\n\t\tplayerlist: null,\n\t},\n\n\tpr: 'pointrally',\n\tpointrally: {\n\t\tname: 'Point Rally',\n\t\tid: 'pointrally',\n\n\t\tpointDistribution: [50, 40, 32, 25, 20, 15, 10],\n\n\t\tmod: {\n\t\t\tname: 'Point Rally',\n\t\t\tid: 'pointrally',\n\t\t\tisGameMode: true,\n\n\t\t\tonLoad() {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tthis.announce(`Round ${++game.round}`);\n\t\t\t},\n\n\t\t\tasync onAfterEnd() {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tfor (const [i, completed] of this.completed.map(e => e.name).entries()) {\n\t\t\t\t\tconst points = (game.pointDistribution[i] ||\n\t\t\t\t\t\tgame.pointDistribution[game.pointDistribution.length - 1]);\n\t\t\t\t\tgame.leaderboard.addPoints(completed, 'points', points);\n\t\t\t\t}\n\t\t\t\t// post leaderboard\n\t\t\t\tconst room = this.room;\n\t\t\t\tconst html = await game.leaderboard.htmlLadder() as string;\n\t\t\t\troom.add(`|raw|${html}`).update();\n\t\t\t},\n\t\t},\n\t\tround: 0,\n\t\tleaderboard: true,\n\t},\n\n\tjs: 'jumpstart',\n\tjump: 'jumpstart',\n\tjumpstart: {\n\t\tname: 'Jump Start',\n\t\tid: 'jumpstart',\n\n\t\tjumpstart: [60, 40, 30, 20, 10],\n\t\tround: 0,\n\t\tmod: {\n\t\t\tname: 'Jump Start',\n\t\t\tid: 'jumpstart',\n\t\t\tisGameMode: true,\n\n\t\t\tonLoad() {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tif (game.round === 0) return;\n\t\t\t\tconst maxTime = Math.max(...game.jumpstart);\n\n\t\t\t\tthis.jumpstartTimers = [];\n\t\t\t\tthis.answerLock = true;\n\n\t\t\t\tfor (const [i, time] of game.jumpstart.entries()) {\n\t\t\t\t\tif (!game.completed[i]) break;\n\n\t\t\t\t\tthis.jumpstartTimers[i] = setTimeout(() => {\n\t\t\t\t\t\tconst target = game.completed.shift();\n\t\t\t\t\t\tif (!target) return;\n\n\t\t\t\t\t\tconst staffHost = Users.get(this.staffHostId);\n\t\t\t\t\t\tconst targetUser = Users.get(target);\n\n\t\t\t\t\t\tif (targetUser) {\n\t\t\t\t\t\t\tif (staffHost) staffHost.sendTo(this.room, `${targetUser.name} has received their first hint early.`);\n\t\t\t\t\t\t\ttargetUser.sendTo(\n\t\t\t\t\t\t\t\tthis.room,\n\t\t\t\t\t\t\t\t`|raw|<strong>The first hint to the next hunt is:</strong> <div style=\"overflow:auto; max-height: 50vh\"> ${this.formatOutput(this.questions[0].hint)}</div>`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\ttargetUser.sendTo(\n\t\t\t\t\t\t\t\tthis.room,\n\t\t\t\t\t\t\t\t`|notify|Early Hint|The first hint to the next hunt is: <div style=\"overflow:auto; max-height: 50vh\">  ${this.formatOutput(this.questions[0].hint)}</div>`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, (maxTime - time) * 1000 + 5000);\n\t\t\t\t}\n\n\t\t\t\t// when the jump starts are all given to eligible players\n\t\t\t\tthis.jumpstartTimers[this.jumpstartTimers.length] = setTimeout(() => {\n\t\t\t\t\tthis.answerLock = false;\n\t\t\t\t\tconst message = this.getCreationMessage(true);\n\t\t\t\t\tthis.room.add(message).update();\n\t\t\t\t\tthis.announce('You may start guessing!');\n\t\t\t\t\tthis.startTime = Date.now();\n\t\t\t\t}, 1000 * (maxTime + 5));\n\t\t\t},\n\n\t\t\tonJoin(user) {\n\t\t\t\tif (this.answerLock) {\n\t\t\t\t\tuser.sendTo(this.room, `The hunt is not open for guesses yet!`);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonViewHunt(user) {\n\t\t\t\tif (this.answerLock && !(this.hosts.some(h => h.id === user.id) || user.id === this.staffHostId)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonCreateCallback() {\n\t\t\t\tif (this.answerLock) {\n\t\t\t\t\treturn `|raw|<div class=\"broadcast-blue\"><strong>${['official', 'unrated'].includes(this.gameType) ? 'An' : 'A'} ${this.gameType} ` +\n\t\t\t\t\t\t`Scavenger Hunt by <em>${Utils.escapeHTML(Chat.toListString(this.hosts.map(h => h.name)))}</em> ` +\n\t\t\t\t\t\t`has been started${(this.hosts.some(h => h.id === this.staffHostId) ? '' : ` by <em>${Utils.escapeHTML(this.staffHostName)}</em>`)}.` +\n\t\t\t\t\t\t`<br />The first hint is currently being handed out to early finishers.`;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonEnd(reset) {\n\t\t\t\tif (this.jumpstartTimers) {\n\t\t\t\t\tfor (const timer of this.jumpstartTimers) {\n\t\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tif (!reset) {\n\t\t\t\t\tif (game.round === 0) {\n\t\t\t\t\t\tgame.completed = this.completed.map(entry => toID(entry.name));\n\t\t\t\t\t\tgame.round++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgame.destroy();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n\n\tts: 'teamscavs',\n\ttscav: 'teamscavs',\n\tteamscavengers: 'teamscavs',\n\tteamscavs: {\n\t\tname: 'Team Scavs',\n\t\tid: 'teamscavs',\n\t\t/* {\n\t\t\t[team\n\t\t\tname: string]: {\n\t\t\t  name: string[],\n\t\t\t  players: UserID[],\n\t\t\t  answers: string[],\n\t\t\t  question: number,\n\t\t\t  completed: boolean\n\t\t\t}\n\t\t  } */\n\t\tteams: {},\n\n\t\tteamAnnounce(player: ScavengerHuntPlayer | User, message: string) {\n\t\t\tconst team = this.getPlayerTeam(player);\n\n\t\t\tfor (const userid of team.players) {\n\t\t\t\tconst user = Users.getExact(userid);\n\t\t\t\tif (!user?.connected) continue; // user is offline\n\n\t\t\t\tuser.sendTo(this.room, `|raw|<div class=\"infobox\">${message}</div>`);\n\t\t\t}\n\t\t},\n\n\t\tgetPlayerTeam(player: ScavengerHuntPlayer | User) {\n\t\t\tconst game = this.room.scavgame!;\n\t\t\tfor (const teamID in game.teams) {\n\t\t\t\tconst team = game.teams[teamID];\n\t\t\t\tif (team.players.includes(player.id)) {\n\t\t\t\t\treturn team;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tadvanceTeam(answerer: ScavengerHuntPlayer, isFinished?: boolean) {\n\t\t\tconst hunt = this.room.getGame(ScavengerHunt)!;\n\n\t\t\tconst team = this.getPlayerTeam(answerer);\n\n\t\t\tteam.question++;\n\t\t\tconst question = hunt.getQuestion(team.question);\n\t\t\tfor (const userid of team.players) {\n\t\t\t\tconst user = Users.getExact(userid);\n\t\t\t\tif (!user) continue;\n\n\t\t\t\tuser.sendTo(this.room, question);\n\t\t\t}\n\t\t\tteam.answers = [];\n\t\t},\n\n\t\tmod: {\n\t\t\tname: 'Team Scavs',\n\t\t\tid: 'teamscavs',\n\t\t\tisGameMode: true,\n\n\t\t\tonLoad() {\n\t\t\t\t// don't let people change their name in the middle of the hunt.\n\t\t\t\tthis.allowRenames = false;\n\t\t\t},\n\n\t\t\tonViewHunt(user) {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tconst team = game.getPlayerTeam(user);\n\t\t\t\tconst player = this.playerTable[user.id];\n\n\t\t\t\tif (!player || !team) return;\n\n\t\t\t\tif (player.currentQuestion !== team.question - 1) player.currentQuestion = team.question - 1;\n\t\t\t\tif (team.completed) player.completed = true;\n\t\t\t},\n\n\t\t\tonSendQuestion(player) {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tconst team = game.getPlayerTeam(player);\n\n\t\t\t\tif (!team) return;\n\n\t\t\t\tif (player.currentQuestion !== team.question - 1) player.currentQuestion = team.question - 1;\n\t\t\t\tif (team.completed) {\n\t\t\t\t\tplayer.completed = true;\n\t\t\t\t\tplayer.sendRoom('Your team has already completed the hunt!');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonConnect(user) {\n\t\t\t\tconst player = this.playerTable[user.id];\n\t\t\t\tif (!player) return;\n\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tconst team = game.getPlayerTeam(player);\n\n\t\t\t\tif (team) {\n\t\t\t\t\tif (player.currentQuestion !== team.question - 1) player.currentQuestion = team.question - 1;\n\t\t\t\t\tif (team.completed) player.completed = true;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonJoin(user) {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tconst team = game.getPlayerTeam(user);\n\t\t\t\tif (!team) {\n\t\t\t\t\tuser.sendTo(this.room, 'You are not allowed to join this scavenger hunt as you are not on any of the teams.');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonAfterLoadPriority: -9999,\n\t\t\tonAfterLoad() {\n\t\t\t\tconst game = this.room.scavgame!;\n\n\t\t\t\tif (Object.keys(game.teams).length === 0) {\n\t\t\t\t\tthis.announce('Teams have not been set up yet.  Please reset the hunt.');\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// -1 so that blind incog takes precedence of this\n\t\t\tonCorrectAnswerPriority: -1,\n\t\t\tonCorrectAnswer(player, value) {\n\t\t\t\tconst game = this.room.scavgame!;\n\n\t\t\t\tif (player.currentQuestion + 1 < this.questions.length) {\n\t\t\t\t\tgame.teamAnnounce(\n\t\t\t\t\t\tplayer,\n\t\t\t\t\t\tUtils.html`<strong>${player.name}</strong> has gotten the correct answer (${value}) for question #${player.currentQuestion + 1}.`\n\t\t\t\t\t);\n\t\t\t\t\tgame.advanceTeam(player);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonAnySubmit(player, value) {\n\t\t\t\tconst game = this.room.scavgame!;\n\n\t\t\t\tconst team = game.getPlayerTeam(player);\n\n\t\t\t\tif (!team) return true; // handle players who get kicked during the hunt.\n\n\t\t\t\tif (player.currentQuestion !== team.question - 1) player.currentQuestion = team.question - 1;\n\t\t\t\tif (team.completed) player.completed = true;\n\n\t\t\t\tif (player.completed) return;\n\n\t\t\t\tif (team.answers.includes(value)) return;\n\t\t\t\tgame.teamAnnounce(player, Utils.html`${player.name} has guessed \"${value}\".`);\n\t\t\t\tteam.answers.push(value);\n\t\t\t},\n\n\t\t\tonCompletePriority: 2,\n\t\t\tonComplete(player, time, blitz) {\n\t\t\t\tconst game = this.room.scavgame!;\n\n\t\t\t\tconst team = game.getPlayerTeam(player);\n\t\t\t\treturn { name: team.name, time, blitz };\n\t\t\t},\n\n\t\t\t// workaround that gives the answer after verifying that completion should not be hidden\n\t\t\tonConfirmCompletion(player, time, blitz) {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tconst team = game.getPlayerTeam(player);\n\t\t\t\tteam.completed = true;\n\t\t\t\tteam.question++;\n\n\t\t\t\tgame.teamAnnounce(\n\t\t\t\t\tplayer,\n\t\t\t\t\tUtils.html`<strong>${player.name}</strong> has gotten the correct answer for question #${player.currentQuestion}.  Your team has completed the hunt!`\n\t\t\t\t);\n\t\t\t},\n\n\t\t\tonEnd() {\n\t\t\t\tconst game = this.room.scavgame!;\n\t\t\t\tfor (const teamID in game.teams) {\n\t\t\t\t\tconst team = game.teams[teamID];\n\t\t\t\t\tteam.answers = [];\n\t\t\t\t\tteam.question = 1;\n\t\t\t\t\tteam.completed = false;\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n};\n\nexport class ScavengerGameTemplate {\n\troom: Room;\n\tplayerlist: null | string[];\n\ttimer: NodeJS.Timeout | null;\n\n\t[k: string]: any;\n\tconstructor(room: Room) {\n\t\tthis.room = room;\n\t\tthis.playerlist = null;\n\t\tthis.timer = null;\n\t}\n\n\tdestroy(force?: boolean) {\n\t\tif (this.timer) clearTimeout(this.timer);\n\t\tconst game = this.room.getGame(ScavengerHunt);\n\t\tif (force && game) game.onEnd(false);\n\t\tthis.room.scavgame = null;\n\t}\n\n\teliminate(userid: string) {\n\t\tif (!this.playerlist?.includes(userid)) return false;\n\t\tthis.playerlist = this.playerlist.filter(pid => pid !== userid);\n\n\t\tif (this.leaderboard) delete this.leaderboard.data[userid];\n\t\treturn true;\n\t}\n\n\tannounce(msg: string) {\n\t\tthis.room.add(`|raw|<div class=\"broadcast-blue\"><strong>${msg}</strong></div>`).update();\n\t}\n}\n\nconst LoadGame = function (room: Room, gameid: string) {\n\tlet game = MODES[gameid];\n\tif (!game) return false; // invalid id\n\tif (typeof game === 'string') game = MODES[game];\n\n\tconst base = new ScavengerGameTemplate(room);\n\n\tconst scavgame = Object.assign(base, Utils.deepClone(game));\n\n\t// initialize leaderboard if required\n\tif (scavgame.leaderboard) {\n\t\tscavgame.leaderboard = new Leaderboard();\n\t}\n\treturn scavgame;\n};\n\nexport const ScavMods = {\n\tLoadGame,\n\ttwists: TWISTS,\n\tmodes: MODES,\n};\n"],
  "mappings": "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",
  "names": []
}
