{
  "version": 3,
  "sources": ["../../server/verifier.ts"],
  "sourcesContent": ["/**\n * Verifier process\n * Pokemon Showdown - http://pokemonshowdown.com/\n *\n * This is just an asynchronous implementation of a verifier for a\n * signed key, because Node.js's crypto functions are synchronous,\n * strangely, considering how everything else is asynchronous.\n *\n * I wrote this one day hoping it would help with performance, but\n * I don't think it had any noticeable effect.\n *\n * @license MIT\n */\nimport * as crypto from 'crypto';\n\nimport { QueryProcessManager } from '../lib/process-manager';\n\nexport const PM = new QueryProcessManager<{ data: string, signature: string }, boolean>(\n\tmodule, ({ data, signature }) => {\n\t\tconst verifier = crypto.createVerify(Config.loginserverkeyalgo);\n\t\tverifier.update(data);\n\t\tlet success = false;\n\t\ttry {\n\t\t\tsuccess = verifier.verify(Config.loginserverpublickey, signature, 'hex');\n\t\t} catch {}\n\n\t\treturn success;\n\t}\n);\n\nexport function verify(data: string, signature: string): Promise<boolean> {\n\treturn PM.query({ data, signature });\n}\n\nif (!PM.isParentProcess) {\n\t// This is a child process!\n\tglobal.Config = require('./config-loader').Config;\n\n\tconst Repl = require('../lib/repl').Repl;\n\t// eslint-disable-next-line no-eval\n\tRepl.start('verifier', (cmd: string) => eval(cmd));\n} else {\n\tPM.spawn(global.Config?.subprocessescache?.verifier ?? 1);\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA,aAAwB;AAExB,6BAAoC;AAfpC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBO,MAAM,KAAK,IAAI;AAAA,EACrB;AAAA,EAAQ,CAAC,EAAE,MAAM,UAAU,MAAM;AAChC,UAAM,WAAW,OAAO,aAAa,OAAO,kBAAkB;AAC9D,aAAS,OAAO,IAAI;AACpB,QAAI,UAAU;AACd,QAAI;AACH,gBAAU,SAAS,OAAO,OAAO,sBAAsB,WAAW,KAAK;AAAA,IACxE,QAAQ;AAAA,IAAC;AAET,WAAO;AAAA,EACR;AACD;AAEO,SAAS,OAAO,MAAc,WAAqC;AACzE,SAAO,GAAG,MAAM,EAAE,MAAM,UAAU,CAAC;AACpC;AAEA,IAAI,CAAC,GAAG,iBAAiB;AAExB,SAAO,SAAS,QAAQ,iBAAiB,EAAE;AAE3C,QAAM,OAAO,QAAQ,aAAa,EAAE;AAEpC,OAAK,MAAM,YAAY,CAAC,QAAgB,KAAK,GAAG,CAAC;AAClD,OAAO;AACN,KAAG,MAAM,OAAO,QAAQ,mBAAmB,YAAY,CAAC;AACzD;",
  "names": []
}
